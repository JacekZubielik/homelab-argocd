---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: traefik  

resources:
- ../../base
- chains.yaml
- middlewares.yaml
- secrets.yaml
#- traefik-dashboard-certificate.yaml
- traefik-tlsoption.yaml
#- traefik-tlsstore.yaml
- traefik-service-monitor.yaml
#- ingressroute-traefik-dashboard.yaml
#- pvc.yaml


#
  # - namespace.yaml
  #- traefik-dashboard-service.yaml
  # - traefik-dashboard-basic-auth.yaml
  # - traefik-dashboard-add-prefix.yaml
  # - traefik-middleware-redirect-https.yaml
  #- traefik-dashboard-external-secret.yaml


  # - traefik-dashboard-api-ingress.yaml
  # =======
  # or use more advanced ingressroute and cert-manager generated cert due to lack of integration
  # - traefik-dashboard-ingressroute.yaml
  # - traefik-dashboard-ingressroute-http-redirect.yaml

patches:
  - target:
      group: rbac.authorization.k8s.io
      version: v1
      kind: ClusterRoleBinding
      name: traefik-role-binding
    patch: |-
      - op: add
        path: /subjects/0/namespace
        value: traefik