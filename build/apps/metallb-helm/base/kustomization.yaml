---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

metadata:
  annotations:
    argocd.argoproj.io/sync-options: SkipDryRunOnMissingResource=true
    argocd.argoproj.io/sync-wave: "0"

helmCharts:
  - name: metallb
    repo: https://metallb.github.io/metallb
    version: 0.13.12
    releaseName: metallb
    namespace: metallb-system 
    includeCRDs: true
    valuesFile: values.yaml 

commonLabels:
  app.kubernetes.io/name: metallb
  app: metallb

configMapGenerator:
- name: metallb-config
  literals:
  - TZ="Europe/Warsaw"


# resources:
# - namespace.yaml

# patches:
#   - target:
#       version: v1
#       group: apps
#       kind: DaemonSet
#       namespace: metallb-system
#       name: speaker
#     patch: |-
#       - op: add
#         path: /spec/template/spec/tolerations/-
#         value: {"effect":"NoSchedule","key":"example.com/some-taint","operator":"Exists"}

# patches:
#   - |-
#       apiVersion: apps/v1
#       kind: Deployment
#       metadata:
#         name: controller
#         namespace: metallb-system
#       spec:
#         template:
#           spec:
#             securityContext:
#               $patch: replace
#               runAsNonRoot: true

# patches:
#   - target:
#       kind: Deployment
#       name: controller
#       namespace: metallb-system
#     patch: |-
#       - op: remove
#         path: /spec/template/spec/securityContext/runAsUser
